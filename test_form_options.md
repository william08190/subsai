# 批量处理界面表单选项测试报告

## 测试日期
2025-11-18

## 表单选项测试状态

### ✅ 已实现且正常工作的选项

| 选项名称 | 字段 | 状态 | 说明 |
|---------|------|------|------|
| 视频比例 | `aspect_ratio` | ✅ 正常 | 支持 16:9, 9:16, 4:3, 1:1, 21:9 |
| 卡拉OK样式 | `style_name` | ✅ 正常 | 支持 classic, modern, neon, elegant, anime |
| 每行单词数 | `words_per_line` | ✅ 正常 | 范围 3-20,默认 10 |
| 字幕距底部距离 | `vertical_margin` | ✅ 正常 | 范围 10-200px,可选 |
| 视频质量 | `crf` | ✅ 正常 | 范围 18-28,默认 18 |
| 编码速度 | `preset` | ✅ 正常 | 9个预设选项 |
| 字体大小 | `fontsize` | ✅ 正常 | 范围 20-100px,可选 |

### ⚠️ UI已实现但后端未支持的选项

| 选项名称 | 字段 | 状态 | 原因 |
|---------|------|------|------|
| 字体名称 | `fontname` / `custom_font` | ❌ 不工作 | 前端收集但后端未处理 |
| 基础颜色 | `primaryColor` / `custom_colors.primary` | ❌ 不工作 | 前端收集但后端未处理 |
| 高亮颜色 | `highlightColor` / `custom_colors.highlight` | ❌ 不工作 | 前端收集但后端未处理 |
| Whisper模型类型 | `whisperModel` / `whisper_model_type` | ❌ 不工作 | 前端收集但后端未处理 |

### 📋 问题详情

#### 1. 字体名称不工作
- **前端**: JavaScript收集了 `fontName` 并作为 `custom_font` 发送
- **后端**: `ProcessConfig` 模型没有 `custom_font` 字段
- **解决方案**: 需要添加后端支持

#### 2. 颜色自定义不工作
- **前端**: JavaScript收集了 `primaryColor` 和 `highlightColor`，组合为 `custom_colors` 对象
- **后端**: `ProcessConfig` 模型没有 `custom_colors` 字段
- **核心问题**: `create_karaoke_subtitles()` 函数不支持颜色自定义参数
- **解决方案**: 需要修改卡拉OK样式系统以支持动态颜色

#### 3. Whisper模型选择不工作
- **前端**: 用户可以选择不同的模型类型（base, small, medium, large-v2, large-v3, large-v3-turbo）
- **后端**: 收集了 `whisper_model_type` 但没有使用
- **当前行为**: 始终使用配置文件中的默认模型（large-v3-turbo）
- **解决方案**: 需要根据用户选择动态构建 model_config

## 测试建议

### 立即可测试的功能
建议用户重点测试以下已实现的功能：
1. ✅ 不同视频比例（9:16 竖屏特别适合短视频平台）
2. ✅ 5种卡拉OK样式切换
3. ✅ 视频质量设置（CRF 18 vs CRF 23 对比文件大小）
4. ✅ 编码速度（fast vs slow 对比处理时间和质量）
5. ✅ 字幕位置调整（vertical_margin）
6. ✅ 字体大小调整（fontsize）

### 暂时无法使用的功能
以下功能UI已存在但暂时不会生效：
1. ❌ 字体名称选择（微软雅黑、黑体、宋体等）
2. ❌ 基础颜色和高亮颜色自定义
3. ❌ Whisper模型类型选择

## 修复优先级

### 优先级 1 - 重要且简单
- [ ] 修复 Whisper 模型选择功能
  - 影响：用户无法选择更快或更准确的模型
  - 难度：低（只需修改配置传递逻辑）

### 优先级 2 - 重要但复杂
- [ ] 实现字体和颜色自定义
  - 影响：用户无法个性化字幕外观
  - 难度：中等（需要修改样式系统架构）

### 建议
鉴于用户已经测试并确认"视频生成字幕符合要求，运行非常稳定"，建议：
1. 保持当前稳定版本不变（v1.0.0-stable）
2. 如果用户需要这些高级自定义功能，可以在新版本中实现
3. 或者简化UI，移除暂时不支持的选项，避免用户困惑
